<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wexford Community School • Digital Report Card System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #0B8F4A; /* Wexford Green */
            --secondary: #003366; /* Dark Blue */
            --accent: #FF6B00; /* Orange */
            --light: #f8fafc;
            --gray: #e2e8f0;
            --dark: #1e293b;
            --danger: #ef4444;
            --warning: #f59e0b;
            --success: #10b981;
            --info: #3b82f6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        /* HEADER WITH ACTUAL LOGO */
        .school-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem 2.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .school-header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path fill="rgba(255,255,255,0.05)" d="M0,0 L100,0 L100,100 Z"/></svg>');
            background-size: cover;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            gap: 1.5rem;
        }
        
        .school-logo {
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            padding: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .logo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: white;
            color: var(--primary);
            font-weight: bold;
            font-size: 0.6rem;
            line-height: 1.2;
            padding: 5px;
        }
        
        .school-info {
            flex: 1;
            max-width: 600px;
        }
        
        .school-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2rem;
            font-weight: 800;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .school-location {
            font-size: 1.1rem;
            font-weight: 600;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }
        
        .school-motto {
            font-size: 1rem;
            font-weight: 500;
            opacity: 0.9;
            font-style: italic;
            margin-top: 0.5rem;
            color: #e2e8f0;
        }
        
        /* MAIN CONTENT */
        .main-content {
            display: flex;
            min-height: 700px;
        }
        
        .form-section {
            flex: 1;
            padding: 2.5rem;
            background: var(--light);
            border-right: 1px solid var(--gray);
        }
        
        .preview-section {
            flex: 1.5;
            padding: 2.5rem;
            background: white;
            display: flex;
            flex-direction: column;
        }
        
        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--secondary);
            display: flex;
            align-items: center;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 0.5rem;
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--primary);
        }
        
        /* FORM STYLES */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--gray);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Open Sans', sans-serif;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(11, 143, 74, 0.1);
        }
        
        .form-row {
            display: flex;
            gap: 1rem;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        /* SUBJECT INPUT */
        .subject-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 0.8rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--gray);
            align-items: center;
        }
        
        .subject-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 0.8rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--secondary);
            color: white;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .remove-subject {
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 6px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.3s;
            justify-self: center;
        }
        
        .remove-subject:hover {
            background: #dc2626;
        }
        
        .add-subject {
            background: var(--light);
            border: 2px dashed var(--gray);
            color: var(--secondary);
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .add-subject:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        /* BUTTONS */
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #0a7d41;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(11, 143, 74, 0.2);
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #00264d;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 51, 102, 0.2);
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        .btn-accent:hover {
            background: #e05e00;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(255, 107, 0, 0.2);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--secondary);
            border: 2px solid var(--secondary);
        }
        
        .btn-outline:hover {
            background: var(--secondary);
            color: white;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        
        /* COMMUNICATION PANEL */
        .communication-panel {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .communication-panel h3 {
            color: var(--secondary);
            margin-bottom: 1rem;
            font-family: 'Montserrat', sans-serif;
        }
        
        .contact-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .communication-buttons {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }
        
        .com-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 15px;
        }
        
        .btn-email {
            background: linear-gradient(135deg, #ea4335, #d14836);
        }
        
        .btn-sms {
            background: linear-gradient(135deg, #34a853, #2e8b57);
        }
        
        .btn-whatsapp {
            background: linear-gradient(135deg, #25d366, #128c7e);
        }
        
        .btn-save {
            background: linear-gradient(135deg, var(--info), #2563eb);
        }
        
        /* REPORT CARD PREVIEW - TWO PAGE LAYOUT */
        .report-card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--gray);
            flex: 1;
            overflow-y: auto;
            position: relative;
        }
        
        /* PAGE CONTROLS */
        .page-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: var(--light);
            border-radius: 8px;
        }
        
        .page-btn {
            padding: 8px 20px;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .page-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .page-btn:hover:not(.active) {
            background: rgba(11, 143, 74, 0.1);
        }
        
        /* PAGES */
        .report-page {
            display: none;
            min-height: 800px;
            position: relative;
        }
        
        .report-page.active {
            display: block;
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* WATERMARK */
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            opacity: 0.08;
            z-index: 1;
            pointer-events: none;
            width: 80%;
            text-align: center;
        }
        
        .watermark-logo {
            font-size: 120px;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .watermark-text {
            font-size: 60px;
            color: var(--secondary);
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            letter-spacing: 5px;
            text-transform: uppercase;
        }
        
        .report-content {
            position: relative;
            z-index: 2;
        }
        
        /* PAGE 1 STYLES */
        .report-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--primary);
        }
        
        .report-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }
        
        .report-subtitle {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 600;
        }
        
        /* STUDENT INFO - MODERN NON-TABLE LAYOUT */
        .student-info-modern {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .info-card {
            background: var(--light);
            border-radius: 10px;
            padding: 1.5rem;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }
        
        .info-value {
            font-size: 1.2rem;
            color: var(--dark);
            font-weight: 600;
        }
        
        /* ACADEMIC PERFORMANCE TABLE */
        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }
        
        .performance-table th {
            background: var(--secondary);
            color: white;
            padding: 12px 10px;
            text-align: center;
            font-weight: 600;
            border: 1px solid var(--secondary);
        }
        
        .performance-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid var(--gray);
        }
        
        .performance-table tr:nth-child(even) {
            background: var(--light);
        }
        
        /* GRADE COLORS */
        .grade-A { color: var(--success); font-weight: 700; }
        .grade-B { color: #3b82f6; font-weight: 700; }
        .grade-C { color: #f59e0b; font-weight: 700; }
        .grade-D { color: #f97316; font-weight: 700; }
        .grade-E { color: #8b5cf6; font-weight: 700; }
        .grade-F { color: var(--danger); font-weight: 700; }
        
        /* PAGE 2 STYLES */
        .page2-content {
            padding-top: 1rem;
        }
        
        /* REMARKS SECTION */
        .remarks-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .remark-box {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 8px;
            border-top: 4px solid var(--primary);
            min-height: 200px;
        }
        
        .remark-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 1rem;
        }
        
        .remark-content {
            line-height: 1.6;
            min-height: 150px;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border: 1px solid var(--gray);
        }
        
        /* GRADING SYSTEM */
        .grading-system {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .grading-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .grading-table th {
            background: var(--primary);
            color: white;
            padding: 10px;
            text-align: center;
        }
        
        .grading-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid var(--gray);
        }
        
        .grading-table tr:nth-child(even) {
            background: white;
        }
        
        /* SIGNATURE SECTION */
        .signature-section {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--gray);
        }
        
        .signature-box {
            text-align: center;
            flex: 1;
        }
        
        .signature-line {
            margin-top: 3rem;
            border-top: 1px solid var(--dark);
            width: 200px;
            margin: 3rem auto 0.5rem;
        }
        
        /* PRINT STYLES */
        @media print {
            .form-section, .action-buttons, .school-header, .no-print, 
            .page-controls, .communication-panel, .summary-box, footer {
                display: none !important;
            }
            
            .preview-section {
                width: 100%;
                padding: 0;
            }
            
            .report-card {
                box-shadow: none;
                border: none;
                padding: 0;
            }
            
            .container {
                max-width: 100%;
                box-shadow: none;
                border-radius: 0;
            }
            
            body {
                background: white;
                padding: 0;
            }
            
            .report-page {
                display: block !important;
                page-break-after: always;
                min-height: auto;
            }
            
            .report-page:last-child {
                page-break-after: auto;
            }
        }
        
        /* RESPONSIVE */
        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 1px solid var(--gray);
            }
            
            .student-info-modern {
                grid-template-columns: 1fr;
            }
            
            .subject-row, .subject-header {
                grid-template-columns: 1.5fr 1fr 1fr 1fr 0.5fr;
                font-size: 0.9rem;
            }
            
            .remarks-section {
                grid-template-columns: 1fr;
            }
            
            .contact-inputs {
                grid-template-columns: 1fr;
            }
            
            .communication-buttons {
                flex-direction: column;
            }
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .school-name {
                font-size: 1.8rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .subject-row, .subject-header {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .subject-row > div {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .subject-row > div::before {
                content: attr(data-label);
                font-weight: 600;
                margin-right: 10px;
            }
            
            .subject-header {
                display: none;
            }
            
            .signature-section {
                flex-direction: column;
                gap: 2rem;
            }
            
            .logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .school-logo {
                margin-right: 0;
                margin-bottom: 1rem;
            }
        }
        
        /* ANIMATIONS */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        /* LOADING STATE */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            color: var(--secondary);
        }
        
        .loading-spinner {
            border: 4px solid var(--gray);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* STUDENT SELECTOR */
        .student-selector {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            border: 1px solid var(--gray);
        }
        
        .student-selector label {
            margin-bottom: 0.8rem;
            display: block;
            font-size: 1.1rem;
        }
        
        .student-selector select {
            font-size: 1rem;
        }
        
        /* SUMMARY BOX */
        .summary-box {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }
        
        .summary-item h3 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .summary-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* FOOTER */
        footer {
            background: var(--secondary);
            color: white;
            padding: 1.5rem;
            text-align: center;
            margin-top: 2rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        /* DOWNLOAD BUTTON */
        .btn-download {
            background: linear-gradient(135deg, var(--accent), #ff8533);
            color: white;
        }
        
        .btn-download:hover {
            background: linear-gradient(135deg, #e05e00, #ff8533);
        }
        
        /* NOTIFICATION */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            border-left: 4px solid var(--success);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            border-left-color: var(--danger);
        }
        
        .notification.warning {
            border-left-color: var(--warning);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- SCHOOL HEADER WITH LOGO -->
        <div class="school-header no-print">
            <div class="logo-container">
                <div class="school-logo">
                    <!-- Logo placeholder - replace with actual image -->
                    <div class="logo-placeholder">
                        NEW WEXFORD<br>
                        COMMUNITY SCHOOL<br>
                        ATWIMA<br>
                        MANHYIA<br>
                        SINCE EST. 1991<br>
                        INNOVATION, TECHNOLOGY<br>
                        & DISCIPLINE
                    </div>
                </div>
                <div class="school-info">
                    <h1 class="school-name">WEXFORD COMMUNITY SCHOOL</h1>
                    <p class="school-location">Atwima Manhyia • Since 1991</p>
                    <p class="school-motto"><i class="fas fa-quote-left"></i> Innovation, Technology, and Discipline <i class="fas fa-quote-right"></i></p>
                </div>
            </div>
        </div>
        
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- FORM SECTION -->
            <div class="form-section no-print">
                <h2 class="section-title"><i class="fas fa-user-edit"></i> Student Information</h2>
                
                <div class="student-selector">
                    <label for="studentSelect"><i class="fas fa-users"></i> Select Student</label>
                    <select id="studentSelect" class="student-select">
                        <option value="">-- Select a student --</option>
                        <!-- Students will be populated by JavaScript -->
                    </select>
                </div>
                
                <!-- COMMUNICATION PANEL -->
                <div class="communication-panel">
                    <h3><i class="fas fa-paper-plane"></i> Send Report to Parents</h3>
                    <div class="contact-inputs">
                        <div class="form-group">
                            <label for="parentEmail"><i class="fas fa-envelope"></i> Parent Email</label>
                            <input type="email" id="parentEmail" placeholder="parent@example.com">
                        </div>
                        <div class="form-group">
                            <label for="parentPhone"><i class="fas fa-phone"></i> Parent Phone</label>
                            <input type="tel" id="parentPhone" placeholder="+233 XX XXX XXXX">
                        </div>
                    </div>
                    <div class="communication-buttons">
                        <button class="btn com-btn btn-email" id="sendEmail">
                            <i class="fas fa-envelope"></i> Send Email
                        </button>
                        <button class="btn com-btn btn-sms" id="sendSMS">
                            <i class="fas fa-sms"></i> Send SMS
                        </button>
                        <button class="btn com-btn btn-whatsapp" id="sendWhatsApp">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="btn com-btn btn-save" id="saveReport">
                            <i class="fas fa-save"></i> Save Report
                        </button>
                    </div>
                </div>
                
                <form id="reportForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentName"><i class="fas fa-user"></i> Student Name</label>
                            <input type="text" id="studentName" placeholder="Enter student's full name" required>
                        </div>
                        <div class="form-group">
                            <label for="rollNumber"><i class="fas fa-hashtag"></i> Number on Roll</label>
                            <input type="text" id="rollNumber" placeholder="e.g., 1, 2, 3..." required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="className"><i class="fas fa-school"></i> Class</label>
                            <input type="text" id="className" placeholder="e.g., BS 5" value="BS 5" required>
                        </div>
                        <div class="form-group">
                            <label for="term"><i class="fas fa-calendar-alt"></i> Term</label>
                            <select id="term" required>
                                <option value="1ST TERM">1ST TERM</option>
                                <option value="2ND TERM">2ND TERM</option>
                                <option value="3RD TERM">3RD TERM</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="academicYear"><i class="fas fa-calendar"></i> Academic Year</label>
                            <input type="text" id="academicYear" placeholder="e.g., 2025-2026" value="2025-2026" required>
                        </div>
                        <div class="form-group">
                            <label for="attendance"><i class="fas fa-chart-line"></i> Attendance</label>
                            <input type="text" id="attendance" placeholder="e.g., 85/90" value="85/90">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="vacationDate"><i class="fas fa-plane-departure"></i> Vacation Date</label>
                            <input type="text" id="vacationDate" placeholder="e.g., 15th December, 2025" value="15th December, 2025">
                        </div>
                        <div class="form-group">
                            <label for="reopeningDate"><i class="fas fa-plane-arrival"></i> Next Term Reopens</label>
                            <input type="text" id="reopeningDate" placeholder="e.g., 10th January, 2026" value="10th January, 2026">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="conduct"><i class="fas fa-user-check"></i> Conduct</label>
                        <textarea id="conduct" placeholder="Enter student conduct remarks..." rows="3">Very well behaved and respectful. Shows good character and discipline.</textarea>
                    </div>
                    
                    <h2 class="section-title" style="margin-top: 2.5rem;"><i class="fas fa-book-open"></i> Academic Performance</h2>
                    <p style="margin-bottom: 1rem; color: #64748b;">Enter marks for Class Work (50%) and Exams (50%)</p>
                    
                    <div class="subject-header">
                        <div>SUBJECT</div>
                        <div>CLASS (50%)</div>
                        <div>EXAMS (50%)</div>
                        <div>POSITION</div>
                        <div>ACTION</div>
                    </div>
                    
                    <div id="subjectsContainer">
                        <!-- Subjects will be added here dynamically -->
                    </div>
                    
                    <div class="add-subject" id="addSubject">
                        <i class="fas fa-plus"></i> Add Another Subject
                    </div>
                    
                    <div class="action-buttons">
                        <button type="button" class="btn btn-primary" id="generateReport">
                            <i class="fas fa-file-alt"></i> Generate Report Card
                        </button>
                        <button type="button" class="btn btn-outline" id="resetForm">
                            <i class="fas fa-redo"></i> Reset Form
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- PREVIEW SECTION -->
            <div class="preview-section">
                <h2 class="section-title"><i class="fas fa-eye"></i> Report Card Preview</h2>
                
                <!-- Page Controls -->
                <div class="page-controls no-print">
                    <button class="page-btn active" data-page="1">Page 1</button>
                    <button class="page-btn" data-page="2">Page 2</button>
                </div>
                
                <div id="loadingPreview" class="loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Generating report card...</p>
                </div>
                
                <div id="reportPreview" class="report-card">
                    <!-- PAGE 1 -->
                    <div id="page1" class="report-page active">
                        <!-- Watermark -->
                        <div class="watermark">
                            <div class="watermark-text">WEXFORD</div>
                        </div>
                        
                        <!-- Report Card Content -->
                        <div class="report-content">
                            <div class="report-header">
                                <h2 class="report-title">TERMINAL REPORT CARD</h2>
                                <p class="report-subtitle">WEXFORD COMMUNITY SCHOOL</p>
                                <p style="color: var(--secondary); font-weight: 500; margin-top: 0.5rem;">
                                    <i class="fas fa-quote-left"></i> Innovation, Technology, and Discipline <i class="fas fa-quote-right"></i>
                                </p>
                            </div>
                            
                            <!-- STUDENT INFORMATION -->
                            <div class="student-info-modern">
                                <div class="info-card">
                                    <div class="info-label">Student Name</div>
                                    <div class="info-value" id="previewName">WESLER NYAMEKYE ASANTE</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Class</div>
                                    <div class="info-value" id="previewClass">BS 5</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Term</div>
                                    <div class="info-value" id="previewTerm">1ST TERM</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Academic Year</div>
                                    <div class="info-value" id="previewYear">2025-2026</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Number on Roll</div>
                                    <div class="info-value" id="previewRoll">1</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Attendance</div>
                                    <div class="info-value" id="previewAttendance">85/90</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Vacation Date</div>
                                    <div class="info-value" id="previewVacation">15th December, 2025</div>
                                </div>
                                
                                <div class="info-card">
                                    <div class="info-label">Next Term Reopens</div>
                                    <div class="info-value" id="previewReopening">10th January, 2026</div>
                                </div>
                            </div>
                            
                            <!-- CONDUCT -->
                            <div style="margin-bottom: 2rem; padding: 1rem; background: #f0f9ff; border-radius: 8px; border-left: 4px solid var(--accent);">
                                <div style="font-weight: 600; color: var(--secondary); margin-bottom: 0.5rem;">Conduct:</div>
                                <div id="previewConduct">Very well behaved and respectful. Shows good character and discipline.</div>
                            </div>
                            
                            <h3 style="margin-bottom: 1rem; color: var(--secondary);">ACADEMIC PERFORMANCE</h3>
                            <table class="performance-table">
                                <thead>
                                    <tr>
                                        <th>SUBJECT</th>
                                        <th>CLASS (50%)</th>
                                        <th>EXAMS (50%)</th>
                                        <th>TOTAL</th>
                                        <th>GRADE</th>
                                        <th>POSITION</th>
                                        <th>REMARK</th>
                                    </tr>
                                </thead>
                                <tbody id="marksTableBody1">
                                    <!-- Marks for Page 1 will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- PAGE 2 -->
                    <div id="page2" class="report-page">
                        <!-- Watermark -->
                        <div class="watermark">
                            <div class="watermark-text">WEXFORD</div>
                        </div>
                        
                        <div class="report-content page2-content">
                            <!-- More subjects (if any) -->
                            <h3 style="margin-bottom: 1rem; color: var(--secondary);">ACADEMIC PERFORMANCE (CONTINUED)</h3>
                            <table class="performance-table">
                                <thead>
                                    <tr>
                                        <th>SUBJECT</th>
                                        <th>CLASS (50%)</th>
                                        <th>EXAMS (50%)</th>
                                        <th>TOTAL</th>
                                        <th>GRADE</th>
                                        <th>POSITION</th>
                                        <th>REMARK</th>
                                    </tr>
                                </thead>
                                <tbody id="marksTableBody2">
                                    <!-- Marks for Page 2 will be populated here -->
                                </tbody>
                            </table>
                            
                            <div class="remarks-section">
                                <div class="remark-box">
                                    <h4 class="remark-title">Teacher's Remark</h4>
                                    <div class="remark-content" id="teacherRemark">
                                        <!-- Teacher's remark will be added here -->
                                    </div>
                                </div>
                                <div class="remark-box">
                                    <h4 class="remark-title">Headteacher's Remark</h4>
                                    <div class="remark-content" id="headteacherRemark">
                                        <!-- Headteacher's remark will be added here -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grading-system">
                                <h4 style="color: var(--secondary); margin-bottom: 0.5rem;">GRADING SYSTEM</h4>
                                <table class="grading-table">
                                    <thead>
                                        <tr>
                                            <th>MARKS RANGE</th>
                                            <th>GRADE</th>
                                            <th>REMARK</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>80 - 100</td>
                                            <td class="grade-A">A</td>
                                            <td>Excellent</td>
                                        </tr>
                                        <tr>
                                            <td>70 - 79</td>
                                            <td class="grade-B">B</td>
                                            <td>Very Good</td>
                                        </tr>
                                        <tr>
                                            <td>60 - 69</td>
                                            <td class="grade-C">C</td>
                                            <td>Good</td>
                                        </tr>
                                        <tr>
                                            <td>50 - 59</td>
                                            <td class="grade-D">D</td>
                                            <td>Credit</td>
                                        </tr>
                                        <tr>
                                            <td>40 - 49</td>
                                            <td class="grade-E">E</td>
                                            <td>Pass</td>
                                        </tr>
                                        <tr>
                                            <td>Below 40</td>
                                            <td class="grade-F">F</td>
                                            <td>Fail</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="signature-section">
                                <div class="signature-box">
                                    <p><strong>Class Teacher's Signature</strong></p>
                                    <div class="signature-line"></div>
                                    <p style="margin-top: 0.5rem;">__________________________</p>
                                </div>
                                <div class="signature-box">
                                    <p><strong>Headteacher's Signature</strong></p>
                                    <div class="signature-line"></div>
                                    <p style="margin-top: 0.5rem;">__________________________</p>
                                </div>
                                <div class="signature-box">
                                    <p><strong>School Stamp</strong></p>
                                    <div style="margin-top: 3rem; font-style: italic;">Date: _________________</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="summary-box no-print" id="summaryBox" style="display: none;">
                    <!-- Summary will be added here -->
                </div>
                
                <div class="action-buttons no-print" style="margin-top: 2rem;">
                    <button class="btn btn-secondary" id="printReport">
                        <i class="fas fa-print"></i> Print Report Card
                    </button>
                    <button class="btn btn-download" id="downloadPDF">
                        <i class="fas fa-download"></i> Download as PDF
                    </button>
                    <button class="btn btn-accent" id="sendAll">
                        <i class="fas fa-paper-plane"></i> Send to All
                    </button>
                </div>
            </div>
        </div>
        
        <!-- FOOTER -->
        <footer class="no-print">
            <div class="footer-links">
                <a href="#"><i class="fas fa-info-circle"></i> About</a>
                <a href="#"><i class="fas fa-shield-alt"></i> Privacy</a>
                <a href="#"><i class="fas fa-phone-alt"></i> Contact</a>
            </div>
            <p>© 2025 Wexford Community School • All Rights Reserved</p>
        </footer>
    </div>

    <!-- NOTIFICATION -->
    <div id="notification" class="notification">
        <div id="notificationMessage"></div>
    </div>

    <script>
        // DOM Elements
        const reportForm = document.getElementById('reportForm');
        const subjectsContainer = document.getElementById('subjectsContainer');
        const addSubjectBtn = document.getElementById('addSubject');
        const generateReportBtn = document.getElementById('generateReport');
        const resetFormBtn = document.getElementById('resetForm');
        const printReportBtn = document.getElementById('printReport');
        const downloadPDFBtn = document.getElementById('downloadPDF');
        const loadingPreview = document.getElementById('loadingPreview');
        const reportPreview = document.getElementById('reportPreview');
        const studentSelect = document.getElementById('studentSelect');
        const summaryBox = document.getElementById('summaryBox');
        const pageButtons = document.querySelectorAll('.page-btn');
        const notification = document.getElementById('notification');
        const notificationMessage = document.getElementById('notificationMessage');
        
        // Communication buttons
        const sendEmailBtn = document.getElementById('sendEmail');
        const sendSMSBtn = document.getElementById('sendSMS');
        const sendWhatsAppBtn = document.getElementById('sendWhatsApp');
        const saveReportBtn = document.getElementById('saveReport');
        const sendAllBtn = document.getElementById('sendAll');
        
        // Student data from the document (30+ students)
        const students = [
            { name: "WESLER NYAMEKYE ASANTE", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "LEMUEL DAPAA AGYABENG", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "DARKO OHENE ANSAH", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "ZAID MUMIN ABDUL", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "BLESSING BANNOR", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "JASON NYARKO BOADU", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "LEO NANA KWAKU BOADUM", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "NATHENIEL ATTA ERA", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "AARON KWAKU FRIMPONG", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "ALEXANDER KWAME", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "BENEDICT BOATENG OPOKU", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "KELVIN AKWASI SARPONG", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "NADAL KOFI SARPONG", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "ONESSIMUS OBENG", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "RONNIE KWABENA YEBOAH", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "DANIEL OSEI", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "IDAHOSAH COPLAND KENNETH OWUSU", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "EVANS YENDER", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "OBADIAH OWUSU ANSAH", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "BRIDGET OWUSU ANSAH", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "QUEEN ANKRAH", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "LYDIA AFRANE", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "EMMANUELLA OWUSU ANTWIWAA", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "BEATRICE BOATENG ABANBILA", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "NANA AMA KYEREWAA AYIREBI", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "RHIAN POKUA", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "OBENG JEWEL", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "HAWA SEIDU", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] },
            { name: "TAKYI LOIS", class: "BS 5", term: "1ST TERM", subjects: ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "SOCIAL STUDIES", "CAREER TECHNOLOGY", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"] }
        ];
        
        // Grading system
        const gradingSystem = [
            { min: 80, max: 100, grade: 'A', remark: 'Excellent' },
            { min: 70, max: 79, grade: 'B', remark: 'Very Good' },
            { min: 60, max: 69, grade: 'C', remark: 'Good' },
            { min: 50, max: 59, grade: 'D', remark: 'Credit' },
            { min: 40, max: 49, grade: 'E', remark: 'Pass' },
            { min: 0, max: 39, grade: 'F', remark: 'Fail' }
        ];
        
        // Teacher remarks based on performance
        const teacherRemarks = [
            "An exceptional student with outstanding performance. Shows great initiative and consistently exceeds expectations. Demonstrates excellent understanding of all subjects.",
            "A very good student who performs well in all subjects. Shows good understanding of concepts and applies knowledge effectively. Consistent effort is evident.",
            "Good performance with room for improvement. Shows understanding of most concepts but needs to work on challenging areas. With more focus, better results can be achieved.",
            "Satisfactory performance. Basic understanding of concepts but needs to put in more effort to improve grades. Regular practice and study will help.",
            "Needs to improve performance. Struggles with several concepts and should seek extra help in weak subjects. More dedication to studies is required."
        ];
        
        // Headteacher remarks
        const headteacherRemarks = [
            "Excellent academic performance. Keep up the good work and continue to be a role model to other students.",
            "Very good results. Continue to work hard and aim for even higher achievement next term.",
            "Good effort shown this term. With more focus and dedication, you can achieve better results.",
            "Satisfactory performance. More effort and commitment to studies is required for improvement.",
            "Needs significant improvement. Must take studies more seriously and seek help where needed."
        ];
        
        // Show notification
        function showNotification(message, type = 'success') {
            notificationMessage.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Page navigation
        pageButtons.forEach(button => {
            button.addEventListener('click', function() {
                const pageNum = this.getAttribute('data-page');
                
                // Update active button
                pageButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Show selected page
                document.querySelectorAll('.report-page').forEach(page => {
                    page.classList.remove('active');
                });
                document.getElementById(`page${pageNum}`).classList.add('active');
            });
        });
        
        // Initialize student dropdown
        function initializeStudentDropdown() {
            studentSelect.innerHTML = '<option value="">-- Select a student --</option>';
            
            students.forEach((student, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${student.name} (${student.class})`;
                studentSelect.appendChild(option);
            });
        }
        
        // Load student data when selected
        studentSelect.addEventListener('change', function() {
            const selectedIndex = this.value;
            
            if (selectedIndex !== "") {
                const student = students[selectedIndex];
                
                // Fill form with student data
                document.getElementById('studentName').value = student.name;
                document.getElementById('className').value = student.class;
                document.getElementById('term').value = student.term;
                document.getElementById('rollNumber').value = parseInt(selectedIndex) + 1;
                
                // Clear existing subjects
                subjectsContainer.innerHTML = '';
                
                // Add subjects for this student
                student.subjects.forEach(subject => {
                    addSubjectRow(subject);
                });
                
                // Generate report automatically
                setTimeout(generateReport, 500);
            }
        });
        
        // Add subject row
        function addSubjectRow(subjectName = "") {
            const subjectRow = document.createElement('div');
            subjectRow.className = 'subject-row fade-in';
            subjectRow.innerHTML = `
                <div data-label="Subject:">
                    <input type="text" class="subjectInput" placeholder="Subject name" value="${subjectName}" required>
                </div>
                <div data-label="Class (50%):">
                    <input type="number" class="classMarks" placeholder="Marks" min="0" max="50" value="${Math.floor(Math.random() * 26) + 25}" required>
                </div>
                <div data-label="Exams (50%):">
                    <input type="number" class="examMarks" placeholder="Marks" min="0" max="50" value="${Math.floor(Math.random() * 26) + 25}" required>
                </div>
                <div data-label="Position:">
                    <input type="number" class="position" placeholder="Position" min="1" value="${Math.floor(Math.random() * 20) + 1}">
                </div>
                <div>
                    <button type="button" class="remove-subject">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            subjectsContainer.appendChild(subjectRow);
            
            // Add event listener to the remove button
            const removeBtn = subjectRow.querySelector('.remove-subject');
            removeBtn.addEventListener('click', function() {
                subjectRow.remove();
                setTimeout(generateReport, 100);
            });
            
            // Add input event listeners
            const subjectInput = subjectRow.querySelector('.subjectInput');
            const classMarks = subjectRow.querySelector('.classMarks');
            const examMarks = subjectRow.querySelector('.examMarks');
            const position = subjectRow.querySelector('.position');
            
            subjectInput.addEventListener('input', generateReport);
            classMarks.addEventListener('input', generateReport);
            examMarks.addEventListener('input', generateReport);
            position.addEventListener('input', generateReport);
        }
        
        // Add subject button event
        addSubjectBtn.addEventListener('click', function() {
            addSubjectRow();
        });
        
        // Generate report card
        generateReportBtn.addEventListener('click', generateReport);
        
        // Reset form
        resetFormBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to reset the form? All data will be lost.')) {
                reportForm.reset();
                subjectsContainer.innerHTML = '';
                
                // Add default subjects
                const defaultSubjects = ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"];
                defaultSubjects.forEach(subject => {
                    addSubjectRow(subject);
                });
                
                // Reset student select
                studentSelect.value = "";
                
                // Reset contact info
                document.getElementById('parentEmail').value = "";
                document.getElementById('parentPhone').value = "";
                
                // Generate default report
                setTimeout(generateReport, 100);
            }
        });
        
        // Print report card
        printReportBtn.addEventListener('click', function() {
            window.print();
        });
        
        // Download as PDF with two pages
        downloadPDFBtn.addEventListener('click', async function() {
            const button = this;
            const originalHTML = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating PDF...';
            button.disabled = true;
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Capture Page 1
                const page1 = document.getElementById('page1');
                const canvas1 = await html2canvas(page1, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                const imgWidth = 210; // A4 width in mm
                const imgHeight1 = (canvas1.height * imgWidth) / canvas1.width;
                
                // Add Page 1 to PDF
                pdf.addImage(canvas1.toDataURL('image/png'), 'PNG', 0, 0, imgWidth, imgHeight1);
                
                // Add new page
                pdf.addPage();
                
                // Capture Page 2
                const page2 = document.getElementById('page2');
                const canvas2 = await html2canvas(page2, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                const imgHeight2 = (canvas2.height * imgWidth) / canvas2.width;
                
                // Add Page 2 to PDF
                pdf.addImage(canvas2.toDataURL('image/png'), 'PNG', 0, 0, imgWidth, imgHeight2);
                
                // Save PDF
                const studentName = document.getElementById('studentName').value || 'ReportCard';
                const className = document.getElementById('className').value || 'Class';
                const term = document.getElementById('term').value || 'Term';
                
                pdf.save(`Wexford_${studentName.replace(/\s+/g, '_')}_${className}_${term}.pdf`);
                
                showNotification('Report card downloaded successfully as PDF!', 'success');
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                showNotification('Error generating PDF. Please try again.', 'error');
            } finally {
                button.innerHTML = originalHTML;
                button.disabled = false;
            }
        });
        
        // Save report function
        saveReportBtn.addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            
            if (!studentName) {
                showNotification('Please enter student name first', 'error');
                return;
            }
            
            // Get all form data
            const reportData = {
                studentName: studentName,
                rollNumber: document.getElementById('rollNumber').value,
                className: document.getElementById('className').value,
                term: document.getElementById('term').value,
                academicYear: document.getElementById('academicYear').value,
                attendance: document.getElementById('attendance').value,
                vacationDate: document.getElementById('vacationDate').value,
                reopeningDate: document.getElementById('reopeningDate').value,
                conduct: document.getElementById('conduct').value,
                parentEmail: document.getElementById('parentEmail').value,
                parentPhone: document.getElementById('parentPhone').value,
                subjects: [],
                timestamp: new Date().toISOString()
            };
            
            // Get subjects data
            const subjectInputs = document.querySelectorAll('.subjectInput');
            const classMarksInputs = document.querySelectorAll('.classMarks');
            const examMarksInputs = document.querySelectorAll('.examMarks');
            const positionInputs = document.querySelectorAll('.position');
            
            for (let i = 0; i < subjectInputs.length; i++) {
                const subject = subjectInputs[i].value.trim();
                const classMarks = parseInt(classMarksInputs[i].value) || 0;
                const examMarks = parseInt(examMarksInputs[i].value) || 0;
                const position = positionInputs[i].value || "";
                
                if (subject) {
                    const total = classMarks + examMarks;
                    const grade = calculateGrade(total);
                    
                    reportData.subjects.push({
                        name: subject,
                        classMarks: classMarks,
                        examMarks: examMarks,
                        total: total,
                        grade: grade.grade,
                        position: position
                    });
                }
            }
            
            // Save to localStorage
            const reports = JSON.parse(localStorage.getItem('wexfordReports') || '[]');
            reports.push(reportData);
            localStorage.setItem('wexfordReports', JSON.stringify(reports));
            
            showNotification(`Report saved successfully for ${studentName}!`, 'success');
        });
        
        // Send Email function
        sendEmailBtn.addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            const parentEmail = document.getElementById('parentEmail').value;
            
            if (!studentName) {
                showNotification('Please generate a report first', 'error');
                return;
            }
            
            if (!parentEmail) {
                showNotification('Please enter parent email address', 'error');
                return;
            }
            
            const className = document.getElementById('className').value;
            const term = document.getElementById('term').value;
            
            // Create email content
            const subject = `Wexford Community School - ${term} Report Card for ${studentName}`;
            const body = `Dear Parent/Guardian,\n\nPlease find attached the ${term} report card for ${studentName} (${className}).\n\nYou can also view it online at your convenience.\n\nBest regards,\nWexford Community School\nAtwima Manhyia`;
            
            // Create mailto link
            const mailtoLink = `mailto:${parentEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            // Open email client
            window.open(mailtoLink, '_blank');
            
            showNotification('Email client opened with report details', 'success');
        });
        
        // Send SMS function
        sendSMSBtn.addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            const parentPhone = document.getElementById('parentPhone').value;
            
            if (!studentName) {
                showNotification('Please generate a report first', 'error');
                return;
            }
            
            if (!parentPhone) {
                showNotification('Please enter parent phone number', 'error');
                return;
            }
            
            const className = document.getElementById('className').value;
            const term = document.getElementById('term').value;
            
            // Create SMS content
            const message = `Wexford School: ${term} report for ${studentName} (${className}) is ready. Check email for details or contact school.`;
            
            // Create sms link
            const smsLink = `sms:${parentPhone}?body=${encodeURIComponent(message)}`;
            
            // Open SMS app
            window.open(smsLink, '_blank');
            
            showNotification('SMS app opened with report notification', 'success');
        });
        
        // Send WhatsApp function
        sendWhatsAppBtn.addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            const parentPhone = document.getElementById('parentPhone').value;
            
            if (!studentName) {
                showNotification('Please generate a report first', 'error');
                return;
            }
            
            if (!parentPhone) {
                showNotification('Please enter parent phone number', 'error');
                return;
            }
            
            const className = document.getElementById('className').value;
            const term = document.getElementById('term').value;
            
            // Create WhatsApp message
            const message = `Dear Parent,\n\n${term} report card for *${studentName}* (${className}) is now available. Please check your email for the detailed report or contact the school office.\n\n*Wexford Community School*\n*Innovation, Technology, and Discipline*`;
            
            // Create WhatsApp link
            const whatsappLink = `https://wa.me/${parentPhone.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp
            window.open(whatsappLink, '_blank');
            
            showNotification('Opening WhatsApp to send report notification', 'success');
        });
        
        // Send to all channels
        sendAllBtn.addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            const parentEmail = document.getElementById('parentEmail').value;
            const parentPhone = document.getElementById('parentPhone').value;
            
            if (!studentName) {
                showNotification('Please generate a report first', 'error');
                return;
            }
            
            if (!parentEmail && !parentPhone) {
                showNotification('Please enter at least one contact method', 'error');
                return;
            }
            
            // Save report first
            saveReportBtn.click();
            
            // Send notifications
            if (parentEmail) {
                setTimeout(() => sendEmailBtn.click(), 100);
            }
            
            if (parentPhone) {
                setTimeout(() => {
                    sendSMSBtn.click();
                    setTimeout(() => sendWhatsAppBtn.click(), 500);
                }, 300);
            }
            
            showNotification('Report sent through all available channels', 'success');
        });
        
        // Generate report function
        function generateReport() {
            // Show loading
            loadingPreview.style.display = 'flex';
            reportPreview.style.opacity = '0.5';
            summaryBox.style.display = 'none';
            
            // Simulate processing delay
            setTimeout(() => {
                // Get form values
                const studentName = document.getElementById('studentName').value || "WESLER NYAMEKYE ASANTE";
                const rollNumber = document.getElementById('rollNumber').value || "1";
                const className = document.getElementById('className').value || "BS 5";
                const term = document.getElementById('term').value || "1ST TERM";
                const academicYear = document.getElementById('academicYear').value || "2025-2026";
                const vacationDate = document.getElementById('vacationDate').value || "15th December, 2025";
                const reopeningDate = document.getElementById('reopeningDate').value || "10th January, 2026";
                const attendance = document.getElementById('attendance').value || "85/90";
                const conduct = document.getElementById('conduct').value || "Very well behaved and respectful. Shows good character and discipline.";
                
                // Get subjects and marks
                const subjectInputs = document.querySelectorAll('.subjectInput');
                const classMarksInputs = document.querySelectorAll('.classMarks');
                const examMarksInputs = document.querySelectorAll('.examMarks');
                const positionInputs = document.querySelectorAll('.position');
                
                let subjects = [];
                let totalClassMarks = 0;
                let totalExamMarks = 0;
                let totalMarks = 0;
                let subjectCount = 0;
                let totalGradePoints = 0;
                
                for (let i = 0; i < subjectInputs.length; i++) {
                    const subject = subjectInputs[i].value.trim();
                    const classMarks = parseInt(classMarksInputs[i].value) || 0;
                    const examMarks = parseInt(examMarksInputs[i].value) || 0;
                    const position = positionInputs[i].value || "";
                    
                    if (subject && !isNaN(classMarks) && !isNaN(examMarks)) {
                        const total = classMarks + examMarks;
                        const grade = calculateGrade(total);
                        const remark = getSubjectRemark(total);
                        
                        subjects.push({
                            name: subject,
                            classMarks: classMarks,
                            examMarks: examMarks,
                            total: total,
                            grade: grade.grade,
                            gradeClass: `grade-${grade.grade}`,
                            position: position,
                            remark: remark
                        });
                        
                        totalClassMarks += classMarks;
                        totalExamMarks += examMarks;
                        totalMarks += total;
                        subjectCount++;
                        
                        // Calculate grade points (A=5, B=4, C=3, D=2, E=1, F=0)
                        const gradePoints = { 'A': 5, 'B': 4, 'C': 3, 'D': 2, 'E': 1, 'F': 0 };
                        totalGradePoints += gradePoints[grade.grade] || 0;
                    }
                }
                
                // Calculate averages
                const averageClassMarks = subjectCount > 0 ? Math.round(totalClassMarks / subjectCount) : 0;
                const averageExamMarks = subjectCount > 0 ? Math.round(totalExamMarks / subjectCount) : 0;
                const averageTotal = subjectCount > 0 ? Math.round(totalMarks / subjectCount) : 0;
                const averageGrade = calculateGrade(averageTotal);
                const averageGradePoints = subjectCount > 0 ? (totalGradePoints / subjectCount).toFixed(2) : 0;
                
                // Determine overall performance
                let performanceIndex;
                if (averageTotal >= 80) performanceIndex = 0;
                else if (averageTotal >= 70) performanceIndex = 1;
                else if (averageTotal >= 60) performanceIndex = 2;
                else if (averageTotal >= 50) performanceIndex = 3;
                else performanceIndex = 4;
                
                // Update preview
                document.getElementById('previewName').textContent = studentName;
                document.getElementById('previewClass').textContent = className;
                document.getElementById('previewTerm').textContent = term;
                document.getElementById('previewYear').textContent = academicYear;
                document.getElementById('previewRoll').textContent = rollNumber;
                document.getElementById('previewVacation').textContent = vacationDate;
                document.getElementById('previewReopening').textContent = reopeningDate;
                document.getElementById('previewAttendance').textContent = attendance;
                document.getElementById('previewConduct').textContent = conduct;
                
                // Split subjects for two pages
                const midPoint = Math.ceil(subjects.length / 2);
                const page1Subjects = subjects.slice(0, midPoint);
                const page2Subjects = subjects.slice(midPoint);
                
                // Update marks table for Page 1
                const marksTableBody1 = document.getElementById('marksTableBody1');
                marksTableBody1.innerHTML = '';
                
                page1Subjects.forEach(subject => {
                    const row = document.createElement('tr');
                    row.className = 'fade-in';
                    row.innerHTML = `
                        <td>${subject.name}</td>
                        <td>${subject.classMarks}</td>
                        <td>${subject.examMarks}</td>
                        <td>${subject.total}</td>
                        <td class="${subject.gradeClass}">${subject.grade}</td>
                        <td>${subject.position}</td>
                        <td>${subject.remark}</td>
                    `;
                    marksTableBody1.appendChild(row);
                });
                
                // Update marks table for Page 2
                const marksTableBody2 = document.getElementById('marksTableBody2');
                marksTableBody2.innerHTML = '';
                
                page2Subjects.forEach(subject => {
                    const row = document.createElement('tr');
                    row.className = 'fade-in';
                    row.innerHTML = `
                        <td>${subject.name}</td>
                        <td>${subject.classMarks}</td>
                        <td>${subject.examMarks}</td>
                        <td>${subject.total}</td>
                        <td class="${subject.gradeClass}">${subject.grade}</td>
                        <td>${subject.position}</td>
                        <td>${subject.remark}</td>
                    `;
                    marksTableBody2.appendChild(row);
                });
                
                // Update remarks
                document.getElementById('teacherRemark').textContent = teacherRemarks[performanceIndex];
                document.getElementById('headteacherRemark').textContent = headteacherRemarks[performanceIndex];
                
                // Update summary box
                summaryBox.style.display = 'grid';
                summaryBox.innerHTML = `
                    <div class="summary-item">
                        <h3>${averageTotal}%</h3>
                        <p>Average Score</p>
                    </div>
                    <div class="summary-item">
                        <h3 class="${averageGrade.gradeClass}">${averageGrade.grade}</h3>
                        <p>Overall Grade</p>
                    </div>
                    <div class="summary-item">
                        <h3>${averageGradePoints}</h3>
                        <p>Grade Point Average</p>
                    </div>
                `;
                
                // Hide loading and show preview
                loadingPreview.style.display = 'none';
                reportPreview.style.opacity = '1';
                
                // Add fade-in animation to new content
                document.querySelectorAll('.fade-in').forEach(el => {
                    el.style.animation = 'fadeIn 0.5s ease forwards';
                });
                
            }, 800);
        }
        
        // Calculate grade based on total marks
        function calculateGrade(total) {
            for (const grade of gradingSystem) {
                if (total >= grade.min && total <= grade.max) {
                    return grade;
                }
            }
            return gradingSystem[gradingSystem.length - 1];
        }
        
        // Get subject remark based on marks
        function getSubjectRemark(total) {
            if (total >= 80) return "Excellent";
            if (total >= 70) return "Very Good";
            if (total >= 60) return "Good";
            if (total >= 50) return "Credit";
            if (total >= 40) return "Pass";
            return "Needs Improvement";
        }
        
        // Initialize the form with default data
        function initializeForm() {
            // Add default subjects
            const defaultSubjects = ["MATHEMATICS", "ENGLISH LANGUAGE", "INTEGRATED SCIENCE", "HISTORY", "COMPUTING", "CREATIVE ART", "RME", "GHANAIAN LANGUAGE"];
            defaultSubjects.forEach(subject => {
                addSubjectRow(subject);
            });
            
            // Populate student dropdown
            initializeStudentDropdown();
            
            // Generate initial report
            generateReport();
        }
        
        // Add input event listeners to form fields
        document.querySelectorAll('#reportForm input, #reportForm select, #reportForm textarea').forEach(input => {
            input.addEventListener('input', generateReport);
        });
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeForm);
    </script>
</body>
</html>
